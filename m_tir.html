<!DOCTYPE html>
<html>
<head>
	<title>Jeu</title>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<div class="full-height-flex">
		<form method="GET" action="/req_tir" class="full-height-flex" style="justify-content: space-between;">
			<div class="gauche">
				<div class="bonus_container">
					<div class="ligne">
						<a><button disabled class="b_connnexion">L'espion</button></a>
						<a><button disabled class="b_connnexion">Sabotage</button></a>
					</div>

					<div class="ligne">
						<a><button disabled class="b_connnexion">Yeux de faucon</button></a>
						<a><button disabled class="b_connnexion">Barils</button></a>
					</div>
				</div> 
				
				<div class="shoot_container">
					<div class="ligne">
						<a href="/req_tir"><button class="b_connnexion">Tirer</button></a>
					</div>
				</div>

				<div class="deplacement_container">
					<div class="ligne_1">
						<a href="/req_deplacement?direction=haut&nom_partie={partie_query}"><button disabled class="mv_haut"></button></a>
					</div>
					
					<div class="ligne_2">
						<a href="/req_deplacement?direction=gauche&nom_partie={partie_query}"><button disabled class="mv_gauche"></button></a>
						<a href="/req_deplacement?direction=droite&nom_partie={partie_query}"><button disabled class="mv_droite"></button></a>
					</div>

					<div class="ligne_3">
						<a href="/req_deplacement?direction=bas&nom_partie={partie_query}"><button disabled class="mv_bas"></button></a>
					</div>
				</div>
			</div>
		
			<div class="centre">
				<div class="carte_bg">
                    {carteAff}
            	</div>

				<input type="hidden" name="nom_partie" value="{partie_query}">
			</div>

			<div class="droite">
				<div class="ligne">
					<a><button disabled class="b_connnexion">Kraken</button></a>
				</div>
				<div class="tour">
					<a href="/req_tour_suivant?nom_partie={partie_query}"><button disabled class="b_connnexion">Tour suivant</button></a>
				</div>
				<div class="pv">
					<div class="pv_container">
						<label class="pv_chiffres" id="vous">
							 
							{pvJ1}
						</label>
						<label class="pv_barre">
							<span class="pv_barre_bg">
								<span id="barreJ1" style="width: {pvJ1_p}%;"></span>
							</span>
							{pseudoJ1}
						</label>
					</div>
					<div class="pv_container">
						<label class="pv_chiffres" id="adv">
							{pvJ2}
						</label>
						<label class="pv_barre">
							<span class="pv_barre_bg">
								<span id="barreJ1" style="width: {pvJ2_p}%;"></span>
							</span>
							{pseudoJ2}
						</label>
					</div>
				</div>			
			</div>
		</form>
	</div>

	<script>
        let checkboxes;

        window.addEventListener("load", function () {
            checkboxes = document.querySelectorAll("form input[type=checkbox]");
            for(let checkbox of checkboxes) {
				console.log("la");
                checkbox.addEventListener("click", handleChecked);
            }
        });

        function handleChecked(event) {
            const count = countChecked(checkboxes);
           	console.log("ici"); 
            if (count >= 3) {
                for (let checkbox of checkboxes) {
                    if (checkbox.checked === false) {
                        checkbox.setAttribute("disabled", true);
                    }
                }
            } else {
                for (let checkbox of checkboxes) {
                    checkbox.removeAttribute("disabled");
                }
            }
        }

        function countChecked(checkboxes) {
            return Array.from(checkboxes.values()).reduce((acc, box) => acc + (box.checked ? 1 : 0), 0);
        }
	</script>

</body>
</html	
